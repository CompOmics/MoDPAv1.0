# MoDPA: Modification-Dependent Protein Associations

Post-translational modifications (PTMs) are key regulators of protein function and cellular processes; however, the overall principles of PTM co-regulation and crosstalk remain to be fully understood. 

To overcome the extreme sparsity and heterogeneity of PTM calls across experiments, MoDPA utilizes a variational autoencoder (VAE) to embed per-site detection profiles into a low-dimensional latent space that preserves covariation while denoising missing data. A PTM association network is constructed by correlating latent representations across experiments.

----------------

### Reproducing the results

To reproduce our publication's results, you will need :

1. A peptidoform identifications (IDs) file
2. A peptidoform counts file
3. A fasta file to map peptidoforms to proteins

(available at ...?)

#### Preprocessing & PTMs quantification:

To speed up the mapping process, a "peptide dictionary" file can be provided, which contains all human tryptic peptides already mapped to proteins. This can be generated by running `1-quant-pipeline-MoDPA_v2/0_preproc_peptide_dict.py`.

The remaining scripts inside the `1-quant-pipeline-MoDPA_v2` parse the peptidoform IDs and counts files to generate absolute counts for each peptidoforms (A). These absolute counts are then used to compute relative PTMs counts (B). 

Example:<br>
`python .\A_Pipeline_Sept2025.py ./v0113-partial/20250217_Peptidoforms_IDs_v0113.csv.gz .\v0113-partial\20251003_Peptidoforms_counts_v0113.csv.gz .\peptide_dict_new.csv.gz .\Human_2023_01_isoforms.fasta.gz`<br>
`python .\B_relative_PTMs.py . 2025-12-19`

#### Prepare VAE training data

Filter the results with `1-quant-pipeline-MoDPA_v2\C_prefilter-relative-PTMs.py` and extract PTM-by-experiment matrices (1 per PTM of interest) using `1-quant-pipeline-MoDPA_v2\D_Get-MoDPA-matrices.py`. Provide the list of PTMs of interest as a .csv file with the following columns:

|AA  |unimod_id|ptm_name       |
|----|---------|---------------|
|C |4 |Carbamidomethyl |

Combine the PTMs of interest into one dataset with `1-quant-pipeline-MoDPA_v2\E_combine-MoDPA-matrices.py`.